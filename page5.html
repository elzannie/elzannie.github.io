<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Friendly Stranger â€“ Safe Choices</title>
<style>
* { box-sizing:border-box; margin:0; padding:0; font-family: Arial, sans-serif; }

body {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: url('images/bedroom.jpg') no-repeat center center;
  background-size: cover;
  overflow: hidden;
  position: relative;
}

/* INTRO OVERLAY */
#intro-overlay {
  position: fixed; inset: 0; background: black; color: white;
  display: flex; justify-content: center; align-items: center;
  text-align: center; z-index: 100; opacity: 1; transition: opacity 1s ease;
}

#intro-text { font-size: 28px; max-width: 600px; line-height: 1.6; letter-spacing: 1px; animation: introFade 2s ease forwards; }

@keyframes introFade {
  0% { opacity: 0; transform: translateY(20px); }
  40% { opacity: 1; transform: translateY(0); }
  80% { opacity: 1; }
  100% { opacity: 0; }
}

/* PHONE */
#phone {
  width: 300px; height: 540px;
  background: linear-gradient(#111827, #020617);
  border-radius: 30px; box-shadow: 0 0 25px rgba(0,0,0,0.6);
  overflow: hidden; display: flex; flex-direction: column;
  transition: transform 1s ease; z-index: 1;
}

#phone-content { height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 10px; }

/* NOTIFICATION POP */
#popup {
  margin: 20px; padding: 15px; background: #333; border-radius: 15px;
  text-align: center; color: white;
  display: none;
  transform: scale(0.5); opacity: 0;
}

.text-pop {
  display: block !important;
  animation: notificationPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

@keyframes notificationPop {
  0% { transform: scale(0.5); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

#popup button {
  margin-top: 12px; margin-left: 6px; padding: 10px 16px;
  border: none; border-radius: 10px; background: #555; color: white;
  cursor: pointer; transition: 0.25s ease;
}
#popup button:hover { background: #777; color: #3520f4; transform: scale(1.1); }

/* BAD ENDING ZOOM */
.char-subtle-zoom { animation: charSlowGrow 4s ease-out forwards; }
@keyframes charSlowGrow { 0% { transform: scale(1); } 100% { transform: scale(1.3); } }

.phone-zoom-final { animation: phoneSwallow 1.2s ease-in forwards !important; }
@keyframes phoneSwallow { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(15); opacity: 0; } }

/* SCREENS */
#failure-screen, #success-screen {
  display: none; position: absolute; inset: 0;
  justify-content: center; align-items: center; flex-direction: column; z-index: 20;
}
#failure-screen { background: rgba(0, 0, 0, 0.8); }
#failure-screen img { width: 300px; border-radius: 15px; margin-bottom: 20px; }
#failure-screen p { color: white; font-size: 26px; text-align: center; width: 85%; }

/* FULL VIEWPORT SUCCESS SCREEN */
#success-screen {
  display: none; 
  position: absolute; 
  inset: 0; 
  justify-content: center; 
  align-items: center; 
  flex-direction: column; 
  z-index: 500; 
  background: rgba(0, 100, 0, 0.9); 
  backdrop-filter: blur(5px);
}

#success-screen img { 
  /* CHANGE LOGO SIZE HERE */
  width: 400px;             /* Adjust this value to change size */
  height: auto; 
  
  /* SHIFT LOGO UP HERE */
  margin-top: -50px;        /* Move the logo higher up the screen */
  
  border-radius: 20px;
  animation: pulse 2s infinite; 
}

#success-screen p { 
  color: white; 
  font-size: 32px; 
  text-align: center; 
  font-weight: bold;
  
  /* SHIFT TEXT UP HERE */
  margin-top: -100px;        /* Pulls text closer to the logo/higher up */
  
  text-shadow: 0 4px 10px rgba(0,0,0,0.5); 
}

#homeBtn {
  position: relative; margin-top: 20px; padding: 12px 28px; font-size: 18px;
  border-radius: 40px; border: none; background: #2d2a4a; color: white; cursor: pointer; transition: 0.3s;
}
#homeBtn:hover { background: white; color: #2d2a4a; border: 2px solid #2d2a4a; transform: scale(1.05); }

#fade-overlay { position: fixed; inset: 0; background: black; opacity: 0; pointer-events: none; z-index: 200; transition: opacity 1s ease; }

@keyframes pulse { 0%, 100% { transform: scale(0.95); } 50% { transform: scale(1); } }
canvas#confetti { position: absolute; inset: 0; pointer-events: none; z-index: 600; }
</style>
</head>

<body>

<div id="game-container">
  <div id="intro-overlay">
    <div id="intro-text">
      You've escaped your phone and now back in your room!<br><br>
      The phone lies silent in your hands.<br>
      But will you make the right choice?
    </div>
  </div>

  <div id="phone">
    <div id="phone-content">
      <div id="popup">
        <p><strong>Jay_irl (not following_)</strong></p>
        <p>Hey ðŸ™‚ You're beautiful... Send me your address so I can come over ðŸ˜‰</p>
        <button id="sendReplyBtn">Reply</button>
        <button id="dontAnswerBtn">Don't answer</button>
      </div>

      <div id="success-screen">
        <img src="images/successful.jpg" alt="Success">
        <p>ðŸŽ‰ Great! You've managed to LOCK IN and made the right choice! Stay safe online! ðŸŽ‰</p>
        <button id="homeBtn">Home</button>
      </div>

      <div id="failure-screen">
        <img id="bad-char-img" src="images/charactersad.jpg" alt="Failure">
        <p id="bad-text">You did not learn your lesson...</p>
      </div>
    </div>
  </div>
  <canvas id="confetti"></canvas>
</div>

<div id="fade-overlay"></div>

<script>
// --- AUDIO OBJECTS ---
const bgm = new Audio('sfx/bedroom.mp3'); bgm.loop = true;
const clickSFX = new Audio('sfx/click.mp3');
const notifSFX = new Audio('sfx/notification.mp3'); // Sound for the text popup
const sadEndingSFX = new Audio('sfx/sadending.mp3');
const happyEndingSFX = new Audio('sfx/happyending.mp3');
const yaySFX = new Audio('sfx/yay.mp3');

function startMusic() {
  bgm.play().catch(() => {
    document.addEventListener('click', () => { bgm.play(); }, { once: true });
  });
}
window.onload = startMusic;

const popup = document.getElementById("popup");
const failureScreen = document.getElementById("failure-screen");
const phone = document.getElementById("phone");
const badImg = document.getElementById("bad-char-img");
const badText = document.getElementById("bad-text");


// Home Button with Click SFX
document.getElementById("homeBtn").onclick = () => {
  clickSFX.play(); // Play the click sound
  
  // Brief delay (200ms) so the user hears the sound before the page redirects
  setTimeout(() => {
    window.location.href = "page1.html";
  }, 200);
};// INTRO LOGIC (Constraint: Timing forces reading)
window.addEventListener("load", () => {
  const intro = document.getElementById("intro-overlay");
  setTimeout(() => {
    intro.style.opacity = "0";
    setTimeout(() => {
      intro.style.display = "none";
      // Trigger Notification and Sound
      popup.classList.add("text-pop");
      notifSFX.play().catch(e => console.log("Sound error:", e));
    }, 1200); 
  }, 2000); 
});

// WRONG CHOICE (Feedback and Scale)
document.getElementById("sendReplyBtn").onclick = () => {
  clickSFX.play(); bgm.pause(); sadEndingSFX.play(); 
  popup.style.display = "none";
  failureScreen.style.display = "flex";
  badImg.classList.add("char-subtle-zoom"); // Subtle scale element

  // Red text appears after delay (Constraint/Narrative Flow)
  setTimeout(() => {
    badText.innerHTML = "<strong style='color:#ff4d4d; font-size: 28px;'>AND YOU GOT STUCK IN YOUR PHONE AGAIN...</strong>";
  }, 2000);

  // The Swallow Animation
  setTimeout(() => {
    badImg.style.visibility = "hidden";
    badText.style.visibility = "hidden";
    failureScreen.style.background = "black"; 
    phone.classList.add("phone-zoom-final");
    document.getElementById("fade-overlay").style.opacity = "1";
  }, 4500);

  setTimeout(() => { window.location.href = "page3.html"; }, 5700);
};

// RIGHT CHOICE 
document.getElementById("dontAnswerBtn").onclick = () => {
  clickSFX.play(); bgm.pause(); happyEndingSFX.play(); yaySFX.play();         
  popup.style.display = "none";
  document.getElementById("success-screen").style.display = "flex";
  startConfetti();
};

document.getElementById("homeBtn").onclick = () => {
  clickSFX.play();
  window.location.href = "page1.html";
};

function startConfetti() {
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  
  // Make sure canvas fills the entire screen
  canvas.width = window.innerWidth; 
  canvas.height = window.innerHeight;

  let pieces = [];
  for(let i=0; i<100; i++) {
    pieces.push({
      x: Math.random() * canvas.width, 
      y: Math.random() * canvas.height - canvas.height, 
      r: Math.random() * 10 + 5, 
      c: 'hsl(' + Math.random() * 360 + ',100%,50%)', 
      v: Math.random() * 4 + 2
    });
  }

  function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    pieces.forEach(p => {
      ctx.fillStyle = p.c;
      ctx.fillRect(p.x, p.y, p.r, p.r);
      p.y += p.v; 

      // Loop logic
      if (p.y > canvas.height) {
        p.y = -20;
        p.x = Math.random() * canvas.width;
      }
    });
    requestAnimationFrame(update);
  }
  update();
}
</script>
</body>
</html>